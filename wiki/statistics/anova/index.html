<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.69.2"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>ANOVA | Datumorphism | Lei Ma</title><meta name=description content="analysis of variance"><meta name=author content="Lei Ma"><meta property="og:title" content="ANOVA"><meta property="og:description" content="analysis of variance"><meta property="og:type" content="article"><meta property="og:url" content="https://datumorphism.leima.is/wiki/statistics/anova/"><meta property="article:published_time" content="2021-03-07T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-07T00:00:00+00:00"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-140452515-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=canonical href=https://datumorphism.leima.is/wiki/statistics/anova/><link rel="shortcut icon" type=image/png href=/logos/logo-square.png><link rel=stylesheet href=/css/bulma.css><link rel=stylesheet href=/css/bulma-divider.min.css><link rel=stylesheet href=/assets/css/bulma-ribbon.min.css><link rel=stylesheet href=/assets/css/tooltip.css><link rel=stylesheet href=https://jenil.github.io/bulmaswatch/united/bulmaswatch.min.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/blog-post.css><link rel=stylesheet href=/css/code-highlighting/dark.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://unpkg.com/applause-button/dist/applause-button.css><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],tags:'ams',processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']},svg:{fontCache:'global'}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:true});</script><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js integrity="sha256-KzZiKy0DWYsnwMF+X1DvQngQ2/FxF7MF3Ff72XcpuPs=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin=anonymous></head><body><header><nav class="navbar is-transparent"><div class=navbar-brand><a class=navbar-item href=/><img src=/site/intelligence.png alt=Datumorphism height=28 style=margin-right:.5em> Datumorphism</a><div class="navbar-burger burger" style=color:#000 data-target=navMenu><span></span><span></span><span></span></div></div><div class=navbar-menu id=navMenu><div class=navbar-start><div class="navbar-item has-dropdown is-hoverable"><a href=/projects class=navbar-link>Notebooks</a><div class=navbar-dropdown><a href=https://datumorphism.leima.is/awesome/ class=navbar-item>Awesome</a>
<a href=https://datumorphism.leima.is/blog/ class=navbar-item>Blog</a>
<a href=https://datumorphism.leima.is/cards/ class=navbar-item>Cards</a>
<a href=https://datumorphism.leima.is/hologram/ class=navbar-item>Hologram</a>
<a href=https://datumorphism.leima.is/reading/ class=navbar-item>Reading Notes</a>
<a href=https://datumorphism.leima.is/til/ class=navbar-item>TIL</a>
<a href=https://datumorphism.leima.is/wiki/ class=navbar-item>Wiki</a></div></div></div><span class=navbar-burger><span></span><span></span><span></span></span><div class=navbar-end><div class=navbar-item><a class=navbar-item href=/blog/>Blog</a>
<a class=navbar-item href=/tags/><i class="fas fa-tags"></i></a><a class=navbar-item href=/graph><i class="fas fa-project-diagram"></i></a><a class=navbar-item href=https://t.me/amneumarkt><i class="fab fa-telegram"></i></a><a class=navbar-item target=blank href=https://github.com/datumorphism><span class=icon><i class="fab fa-github"></i></span></a></div></div></div></nav><script>document.addEventListener('DOMContentLoaded',()=>{const $navbarBurgers=Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'),0);if($navbarBurgers.length>0){$navbarBurgers.forEach(el=>{el.addEventListener('click',()=>{const target=el.dataset.target;const $target=document.getElementById(target);el.classList.toggle('is-active');$target.classList.toggle('is-active');});});}});</script></header><main><div class=container itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=name content="ANOVA"><meta itemprop=description content="analysis of variance"><meta itemprop=datePublished content="2021-03-07T00:00:00+00:00"><meta itemprop=dateModified content="2021-03-07T00:00:00+00:00"><meta itemprop=wordCount content="515"><meta itemprop=keywords content="statistics,variacne,ANOVA,"><section class=section><div class=container><article class=post><header class=post-header><nav class="breadcrumb has-succeeds-separator is-small" aria-label=breadcrumbs><ul><li><a href=https://datumorphism.leima.is/>Datumorphism</a></li><li><a href=https://datumorphism.leima.is/wiki/>Wiki</a></li><li><a href=https://datumorphism.leima.is/wiki/statistics/>Statistics</a></li><li class=active><a href=https://datumorphism.leima.is/wiki/statistics/anova/>ANOVA</a></li></ul></nav><h1 class="post-title has-text-centered is-size-1" itemprop="name headline">ANOVA</h1><h2 class="title is-6 has-text-centered"><i class="fas fa-tags" style=margin-right:.5em></i><a href=/tags/statistics><span class="tag is-warning is-small is-light">#statistics</span></a>
<a href=/tags/variacne><span class="tag is-warning is-small is-light">#variacne</span></a>
<a href=/tags/anova><span class="tag is-warning is-small is-light">#ANOVA</span></a></h2></header><div class=columns><div class="column is-8"><div class=is-divider data-content=ARTICLE></div><div class="content blog-post section" itemprop=articleBody><p>In many problems, we have to test if several distributions associated with several groups of experiments are the same. The null hypothesis to be used is</p><p>The distributions of several groups are the same.</p><p>ANOVA tests the null hypothesis by comparing the variability between groups and within groups. If the variability between groups are significantly larger than the variability within groups, we are more confident that the distributions of different groups are different.</p><p>We will use two-group experiments as an example. We use a fake dataset:</p><table><thead><tr><th>Group A</th></tr></thead><tbody><tr><td>$x^A_1$</td></tr><tr><td>$x^A_2$</td></tr><tr><td>&mldr;</td></tr><tr><td>$x^A_{N_A}$</td></tr></tbody></table><table><thead><tr><th>Group B</th></tr></thead><tbody><tr><td>$x^B_1$</td></tr><tr><td>$x^B_2$</td></tr><tr><td>&mldr;</td></tr><tr><td>$x^B_{N_B}$</td></tr></tbody></table><h2 id=within-group-variability>Within Group Variability</h2><p>The within group variability is proportional to</p><p>$$
\sigma_{in} \propto \sum_{i_A} (x_{i_A} - \bar x^A ) + \sum_{i_B} (x_{i_B} - \bar x^B ),
$$</p><p>where $\bar x^A$ is the mean within group $A$ and $\bar x^B$ is the mean within group $B$.</p><p>We will play &ldquo;the extreme game&rdquo; to get the normalizing constant. We can tolerate larger $\sum_{i_A} (x_{i_A} - \bar x^A ) + \sum_{i_B} (x_{i_B} - \bar x^B )$ if we have more data points $N_A+N_B$ since a sum is likely to be larger for more data points. On the other hand, the more groups we have, the smaller $\sum_{i_A} (x_{i_A} - \bar x^A ) + \sum_{i_B} (x_{i_B} - \bar x^B )$ can be tolerated since the groups will start to overlap more easily.</p><p>A naive guess would lead to</p><p>$$
\sigma_{in} = \frac{\sum_{i_A} (x_{i_A} - \bar x^A ) + \sum_{i_B} (x_{i_B} - \bar x^B )}{N_A+N_B - k},
$$</p><p>where $k=2$ is the number of groups.</p><h2 id=between-group-variability>Between Group Variability</h2><p>The between group variability is measured by the differences in the group means.</p><p>The mean of group A is $\bar x^A$ and the mean of group B is $\bar x^B$. Here we define the grand mean to be $\bar x = \sum_{\text{all in group A and B}} x_i/(N_A+N_B)$.</p><p>The variability between groups is proportional to the sum of variability based on the means</p><p>$$
\sigma_{between} = \frac{N_A(\bar x^A - \bar x )^2 + N_B(\bar x^B - \bar x )^2}{k},
$$</p><p>where $k=2$ is the number of groups.</p><h2 id=anova>ANOVA</h2><p>ANOVA utilizes the F-test with F value defined as</p><p>$$
F = \frac{\sigma_{between}}{\sigma_{in}}.
$$</p><p>The $p$ value can be looked up in a F-table.</p><h2 id=python-code>Python Code</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> numpy <span style=color:#f92672>as</span> np
<span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#f92672>as</span> plt
<span style=color:#f92672>import</span> scipy.stats <span style=color:#f92672>as</span> stats

<span style=color:#75715e># Generate Gaussian data</span>
a_dist <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(loc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, scale<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>)
b_dist <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(loc<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>, scale<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>)

<span style=color:#75715e># Create plot for the two distributions</span>
fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6.18</span>))
ax<span style=color:#f92672>.</span>hist(a_dist, bins<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span>, density<span style=color:#f92672>=</span>True)
ax<span style=color:#f92672>.</span>hist(b_dist, bins<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span>, density<span style=color:#f92672>=</span>True)
ax<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#34;Values&#34;</span>)
ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#34;Histogram of Distribution A and B&#34;</span>)
plt<span style=color:#f92672>.</span>show()

</code></pre></div><figure><img src=../assets/anova/hist_a_and_b.png></figure><p>Now we can performance a one-way ANOVA.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#75715e># One-way ANOVA</span>
stats<span style=color:#f92672>.</span>f_oneway(a_dist, b_dist)
</code></pre></div><p>We get</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>F_onewayResult(statistic<span style=color:#f92672>=</span><span style=color:#ae81ff>135.10932572037217</span>, pvalue<span style=color:#f92672>=</span><span style=color:#ae81ff>2.873326981106292e-30</span>)
</code></pre></div><h2 id=n-way-anova>N-way ANOVA</h2><p>ANOVA test can be done even if we have multiple categorical variables, i.e., multiple . For example, for two variables, we build a table to investigate the possible effects with the rows being the classes of one variable and the columns being the classes of another variable. The samples spanned by these two directions can be used to test the effect of the variables on different combinations of the variables.</p></div><p><div class="has-text-right is-size-7"><span class=icon><i class="fas fa-pencil-alt"></i></span>Published: <time datetime=2021-03-07T00:00:00+00:00>2021-03-07</time>
by <span itemprop=author>Lei Ma</span>;</div></p><div class=is-divider></div><nav class="pagination is-centered" role=navigation aria-label=pagination><a href="https://datumorphism.leima.is/wiki/statistics/multidimensional-data/?ref=footer" class=pagination-previous>« Describing Multi-dimensional Data</a></nav></div><div class="column is-4"><div class=is-divider data-content="Cite Me"></div><div class="box is-size-7 has-text-white has-background-black"><article class=media style=overflow-x:scroll><div class=media-content><div class=content><p>LM (2021). 'ANOVA', Datumorphism, 03 April. Available at: https://datumorphism.leima.is/wiki/statistics/anova/.</p></div></div></article></div><style>#TableOfContents>ul{list-style-type:lower-greek;padding-left:0}#TableOfContents>ul>li ul{list-style-type:none;padding-left:1em}</style><div class=is-divider data-content=ToC></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><details><summary>Table of Contents</summary><div><div><nav id=TableOfContents><ul><li><a href=#within-group-variability>Within Group Variability</a></li><li><a href=#between-group-variability>Between Group Variability</a></li><li><a href=#anova>ANOVA</a></li><li><a href=#python-code>Python Code</a></li><li><a href=#n-way-anova>N-way ANOVA</a></li></ul></nav></div></div></details></div></div></article></div><script>const el=document.querySelector('details summary')
el.onclick=()=>{(function(l,o,a,d,e,r){e=o.createElement(a),r=o.getElementsByTagName(a)[0];e.async=1;e.src=d;r.parentNode.insertBefore(e,r)})(window,document,'script','/js/smoothscroll.js');el.onclick=null}
document.querySelectorAll('#TableOfContents a').forEach(link=>{link.addEventListener('click',()=>{document.querySelector(link.href.slice(link.href.indexOf('#'))).scrollIntoView({behavior:'smooth'})})})</script><div class=is-divider data-content=REFERENCES></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><p><strong>References:</strong><br><ol><li class=has-text-weight-bold><a href style=text-decoration:none>Fox, J. Applied Regression Analysis and Generalized Linear Models. (SAGE Publications, 2015).</a></li><li class=has-text-weight-bold><a href=https://www.analyticsvidhya.com/blog/2018/01/anova-analysis-of-variance style=text-decoration:none>A Simple Introduction to ANOVA (with applications in Excel)</a></li></ol></p></div></div></article></div><div class=is-divider data-content=CONNECTUME></div><div class="box is-size-7"><article class=media><div class=media-content style=width:100%><div class=content><p><strong>Current Ref:</strong><br><ul><li style=list-style:none><div style=overflow-x:scroll>wiki/statistics/anova.md</div></li></ul></p></div></div></article></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><p><strong>Links to:</strong><div><a class=box href=https://datumorphism.leima.is/wiki/statistical-hypothesis-testing/hypothesis-testing/><div class=media-content><div class=content><h6>Statistical Hypothesis Testing</h6><p>hypothesis testing is about the probability of alternative hypothesis if the null hypothesis is …</p></div></div></a></div></p></div></div></article></div><div id=comments class=is-divider data-content=COMMENTS></div><script src=https://utteranc.es/client.js repo=datumorphism/comments issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></article></div></section></div><div class=navtools><a class="button is-primary is-light is-outlined" alt="Edit this page" href=https://github.com/datumorphism/datumorphism.github.io/edit/hugo/content/wiki/statistics/anova.md target=blank style=position:fixed;bottom:20px;right:10px;border-radius:9999px;width:35px;height:35px><i class="fas fa-pencil-alt"></i></a><a class="button is-primary is-light is-outlined" href=#comments alt=Comments style=position:fixed;bottom:60px;right:10px;border-radius:9999px;width:35px;height:35px><i class="far fa-comments"></i></a><a class="button is-primary is-light is-outlined" data-lyket-type=updown data-lyket-id=anova data-lyket-namespace=Datumorphism data-lyket-template=reddit style=width:35px;height:35px;position:fixed;bottom:120px;right:10px;border-radius:9999px></a></div></main><footer><footer class=footer><div class=container><div class="content has-text-centered"><p>Created and maintained by <a href=https://leima.is>Lei Ma</a>.
Acknowledgement: <a href=https://gohugo.io/>Hugo</a>,
<a href=https://themes.gohugo.io/bulma/>Bulma</a>, <a href=https://kausalflow.com>KausalFlow</a>.
<strong>love</strong>.<br><a class=tag href=/about>About</a>
<a class=tag href=/index.xml>Feed</a>
<a class=tag href=/data.json>JSON Data</a></p></div></div></footer><script src=https://unpkg.com/applause-button/dist/applause-button.js></script></footer><script src="https://unpkg.com/@lyket/widget@latest/dist/lyket.js?apiKey=4df20b7e32f469fed5dc53f5ab39d8&disableSessionId"></script><script async type=text/javascript src=/js/bulma.js></script></body></html>