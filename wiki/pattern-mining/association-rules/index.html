<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.69.2"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Association Rules | Datumorphism | Lei Ma</title><meta name=description content="Frequent patterns using association rules"><meta name=author content="Lei Ma"><meta property="og:title" content="Association Rules"><meta property="og:description" content="Frequent patterns using association rules"><meta property="og:type" content="article"><meta property="og:url" content="https://datumorphism.leima.is/wiki/pattern-mining/association-rules/"><meta property="article:published_time" content="2019-01-06T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-06T00:00:00+00:00"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-140452515-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=canonical href=https://datumorphism.leima.is/wiki/pattern-mining/association-rules/><link rel="shortcut icon" type=image/png href=/logos/logo-square.png><link rel=stylesheet href=/css/bulma.css><link rel=stylesheet href=/css/bulma-divider.min.css><link rel=stylesheet href=/assets/css/bulma-ribbon.min.css><link rel=stylesheet href=/assets/css/tooltip.css><link rel=stylesheet href=https://jenil.github.io/bulmaswatch/united/bulmaswatch.min.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/blog-post.css><link rel=stylesheet href=/css/code-highlighting/dark.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://unpkg.com/applause-button/dist/applause-button.css><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],tags:'ams',processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']},svg:{fontCache:'global'}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:true});</script><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js integrity="sha256-KzZiKy0DWYsnwMF+X1DvQngQ2/FxF7MF3Ff72XcpuPs=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin=anonymous></head><body><header><nav class="navbar is-transparent"><div class=navbar-brand><a class=navbar-item href=/><img src=/site/intelligence.png alt=Datumorphism height=28 style=margin-right:.5em> Datumorphism</a><div class="navbar-burger burger" style=color:#000 data-target=navMenu><span></span><span></span><span></span></div></div><div class=navbar-menu id=navMenu><div class=navbar-start><div class="navbar-item has-dropdown is-hoverable"><a href=/projects class=navbar-link>Notebooks</a><div class=navbar-dropdown><a href=https://datumorphism.leima.is/awesome/ class=navbar-item>Awesome</a>
<a href=https://datumorphism.leima.is/blog/ class=navbar-item>Blog</a>
<a href=https://datumorphism.leima.is/cards/ class=navbar-item>Cards</a>
<a href=https://datumorphism.leima.is/hologram/ class=navbar-item>Hologram</a>
<a href=https://datumorphism.leima.is/reading/ class=navbar-item>Reading Notes</a>
<a href=https://datumorphism.leima.is/til/ class=navbar-item>TIL</a>
<a href=https://datumorphism.leima.is/wiki/ class=navbar-item>Wiki</a></div></div></div><span class=navbar-burger><span></span><span></span><span></span></span><div class=navbar-end><div class=navbar-item><a class=navbar-item href=/blog/>Blog</a>
<a class=navbar-item href=/tags/><i class="fas fa-tags"></i></a><a class=navbar-item href=/graph><i class="fas fa-project-diagram"></i></a><a class=navbar-item href=https://t.me/amneumarkt><i class="fab fa-telegram"></i></a><a class=navbar-item target=blank href=https://github.com/datumorphism><span class=icon><i class="fab fa-github"></i></span></a></div></div></div></nav><script>document.addEventListener('DOMContentLoaded',()=>{const $navbarBurgers=Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'),0);if($navbarBurgers.length>0){$navbarBurgers.forEach(el=>{el.addEventListener('click',()=>{const target=el.dataset.target;const $target=document.getElementById(target);el.classList.toggle('is-active');$target.classList.toggle('is-active');});});}});</script></header><main><div class=container itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=name content="Association Rules"><meta itemprop=description content="Frequent patterns using association rules"><meta itemprop=datePublished content="2019-01-06T00:00:00+00:00"><meta itemprop=dateModified content="2019-01-06T00:00:00+00:00"><meta itemprop=wordCount content="1260"><meta itemprop=keywords content="Basics,Pattern,"><section class=section><div class=container><article class=post><header class=post-header><nav class="breadcrumb has-succeeds-separator is-small" aria-label=breadcrumbs><ul><li><a href=https://datumorphism.leima.is/>Datumorphism</a></li><li><a href=https://datumorphism.leima.is/wiki/>Wiki</a></li><li><a href=https://datumorphism.leima.is/wiki/pattern-mining/>Pattern Mining</a></li><li class=active><a href=https://datumorphism.leima.is/wiki/pattern-mining/association-rules/>Association Rules</a></li></ul></nav><h1 class="post-title has-text-centered is-size-1" itemprop="name headline">Association Rules</h1><h2 class="title is-6 has-text-centered"><i class="fas fa-tags" style=margin-right:.5em></i><a href=/tags/basics><span class="tag is-warning is-small is-light">#Basics</span></a>
<a href=/tags/pattern><span class="tag is-warning is-small is-light">#Pattern</span></a></h2></header><div class=columns><div class="column is-8"><div class=is-divider data-content=ARTICLE></div><div class="content blog-post section" itemprop=articleBody><p>Association rule is a method for pattern mining. In this article, we perform an association rule analysis of some demo data.</p><h2 id=the-problem-defined>The Problem Defined</h2><p>Suppose we own a store called KIOSK. Here at KIOSK, we sell 4 different things.</p><ol><li>Milk</li><li>Croissant</li><li>Coffee</li><li>Fries</li></ol><p>We need to know what items are associated with each other when the customers are buying.</p><p>We have collected the following data. Beware that this small amount of data might not be enough for a real-world problem.</p><table><thead><tr><th align=center>INDEX</th><th align=center>Items</th></tr></thead><tbody><tr><td align=center>1</td><td align=center>croissant, milk</td></tr><tr><td align=center>2</td><td align=center>coffee, croissant</td></tr><tr><td align=center>3</td><td align=center>coffee, croissant</td></tr><tr><td align=center>4</td><td align=center>coffee, croissant, milk</td></tr><tr><td align=center>5</td><td align=center>coffee, milk</td></tr><tr><td align=center>6</td><td align=center>fries, milk</td></tr><tr><td align=center>7</td><td align=center>coffee, croissant, fries</td></tr><tr><td align=center>8</td><td align=center>croissant, fries</td></tr><tr><td align=center>9</td><td align=center>croissant, milk</td></tr><tr><td align=center>10</td><td align=center>croissant, fries, milk</td></tr><tr><td align=center>11</td><td align=center>coffee, croissant, milk</td></tr></tbody></table><h2 id=the-rule-support-and-confidence>The Rule, Support, and Confidence</h2><p>The Association rule has three components: the rule, the support, and the confidence.</p><p>$$
\text{Milk} \Rightarrow \text{Croissant} [ \text{support} = 5/11, \text{confidence} = 5/7 ]
$$</p><p>In this rule, the first part is the rule it self, $\text{Milk} \Rightarrow \text{Croissant}$. It means that if the customers are buying milk they buy croissants too. The <strong>support</strong> is the probability of the records with both milk and croissant (5) among all the records (11). The <strong>confidence</strong> is the conditional probability that the records have croissant given milk in the record.</p><p>Then we define two thresholds that tell us whether this rule is valid.</p><ol><li>Support threshold</li><li>Confidence threshold</li></ol><p>If the support and confidence are both larger than the thresholds, we say the rule is valid.</p><article class="message is-info is-light"><div class=message-body>Sometimes it is easier to deal with <strong>support counts</strong> instead of support probability itself.</div></article><p>It is, however, very hard to calculate association rules with many items without a smart idea. Suppose we have 10 items, the total number of possible association rules is 10!=3628800. It is not practical to explore all the possible combinations.</p><h2 id=keywords>Keywords</h2><ol><li>itemset: a set that contains items such as milk, coffee, etc.</li><li>k-itemset: an itemset with k items</li><li>frequent: an itemset is frequent if it&rsquo;s support count is larger than the threshold (minimum support count). In this article, we define the <strong>minimum support count to be 2</strong>.</li></ol><h2 id=algorithms>Algorithms</h2><p>As long as we have frequent itemsets, it is easy to calculate the association rule. We need some algorithms to calculate the frequent itemsets. For example, we could use some algorithms to</p><ol><li>eliminate some of the possible combinations when generating a pool of rules to be calculated,</li><li>or enable parallel computations,</li><li>or better search algorithms.</li></ol><h3 id=apriori-method>Apriori Method</h3><p>Apriori method is based on a simple rule: <strong>Subsets of a frequent k-itemset should also be frequent.</strong></p><p>For example, if {coffee, croissant} is a frequent itemset, {coffee} and {croissant} must be frequent itemsets. This rule allows us to calculate less combinations.</p><p>The following calculations assumed a <strong>minimum support count of 2</strong>.</p><h4 id=identifying-frequent-itemsets>Identifying Frequent Itemsets</h4><p>To find all the frequent 1-itemsets, we simply explore all the possible 1-itemsets.</p><ol><li><p>Construct itemsets and calculate the support count of all the 1-itemsets.</p><table><thead><tr><th align=center>1-itemset</th><th align=center>support count</th></tr></thead><tbody><tr><td align=center>{coffee}</td><td align=center>6</td></tr><tr><td align=center>{croissant}</td><td align=center>9</td></tr><tr><td align=center>{fries}</td><td align=center>3</td></tr><tr><td align=center>{milk}</td><td align=center>7</td></tr></tbody></table></li><li><p>Drop all 1-itemsets that have support count less than 2. In our example, all the 1-itemsets are frequent.</p><table><thead><tr><th align=center>1-itemset</th><th align=center>support count</th></tr></thead><tbody><tr><td align=center>{coffee}</td><td align=center>6</td></tr><tr><td align=center>{croissant}</td><td align=center>9</td></tr><tr><td align=center>{fries}</td><td align=center>3</td></tr><tr><td align=center>{milk}</td><td align=center>7</td></tr></tbody></table></li></ol><p>To find all the frequent 2-itemsets, we construct the 2-itemsets using frequent 1-itemsets only.</p><ol><li><p>Construct 2-itemsets based on the frequent 1-itemsets. We choose two 1-itemsets from the frequent 1-itemsets and find the union.</p><table><thead><tr><th align=center>2-itemset</th><th align=center>support count</th></tr></thead><tbody><tr><td align=center>{coffee, croissant}</td><td align=center>5</td></tr><tr><td align=center>{coffee, fries}</td><td align=center>1</td></tr><tr><td align=center>{coffee, milk}</td><td align=center>3</td></tr><tr><td align=center>{croissant, fries}</td><td align=center>3</td></tr><tr><td align=center>{croissant, milk}</td><td align=center>5</td></tr><tr><td align=center>{fries, milk}</td><td align=center>2</td></tr></tbody></table></li><li><p>Drop itemsets with support count less than 2. We get the frequent 2-itemsets.</p><table><thead><tr><th align=center>2-itemset</th><th align=center>support count</th></tr></thead><tbody><tr><td align=center>{coffee, croissant}</td><td align=center>5</td></tr><tr><td align=center>{coffee, milk}</td><td align=center>3</td></tr><tr><td align=center>{croissant, fries}</td><td align=center>3</td></tr><tr><td align=center>{croissant, milk}</td><td align=center>5</td></tr><tr><td align=center>{fries, milk}</td><td align=center>2</td></tr></tbody></table></li></ol><p>To find all the frequent 3-itemsets, we construct 3-itemsets using frequent 2-itemsets.</p><ol><li><p>Construct 3-itemsets by joining 2-itemsets that have 3-2=1 item in common. This is done in two steps. First, we find 2-itemset that has 3-2=1 item in common, e.g., {coffee, croissant}, {coffee, fries}, {coffee, milk}. Secondly, we choose two of them and union, e.g. {coffee, croissant} union {coffee, fries} = {coffee, croissant, fries}.</p><table><thead><tr><th align=center>3-itemset</th><th align=center>support count</th></tr></thead><tbody><tr><td align=center>{coffee, croissant, fries}</td><td align=center>1</td></tr><tr><td align=center>{coffee, croissant, milk}</td><td align=center>2</td></tr><tr><td align=center>{coffee, fries, milk}</td><td align=center>0</td></tr><tr><td align=center>{croissant, fries, milk}</td><td align=center>1</td></tr></tbody></table></li><li><p>Drop itemsets with support count less than 2.</p><table><thead><tr><th align=center>3-itemset</th><th align=center>support count</th></tr></thead><tbody><tr><td align=center>{coffee, croissant, milk}</td><td align=center>2</td></tr></tbody></table></li></ol><p>Our calculation stops here since any 4-itemset would require at least two frequent 3-itemsets which we have only one.</p><p>However, it is straightforward to construct the 4-itemsets if we had frequent 3-itemsets. We find 3-itemsets that have 4-2=2 items in common. Then we choose any two itemsets from them and union.</p><h4 id=generating-association-rules-and-calculating-the-confidence>Generating Association Rules and Calculating the Confidence</h4><p>Association rules are generated by splitting the itemsets into two subsets without intersections. Suppose we are constructing association rules from {coffee, croissant, milk}. We follow three steps.</p><ol><li><p>Find the subsets. Here we have $C^3_1=3$ combinations.</p><ol><li>{coffee}, {croissant, milk}</li><li>{coffee, croissant}, {milk}</li><li>{coffee, milk}, {croissant}</li></ol></li><li><p>The rules will be from one of the subsets to another, e.g., {coffee} to {croissant, milk}. We have 6 in total.</p></li><li><p>The confidence of the rule $\text{ {coffee} } \Rightarrow \text{ {croissant, milk} }$ is</p><p>$$
\text{Confidence} = \frac{ \text{Support Count of {croissant, milk} } }{ \text{Support Count of {coffee} } } = \frac{5}{6} = 83.3%
$$</p></li></ol><h3 id=pattern-growth-approach>Pattern-growth Approach</h3><p>The problem with the Priori method is that the search is still querying the table again and again on each itemset build. Pattern-growth approach is different since it builds a tree, with the name frequent-pattern tree (FP-tree) with a few table scans.</p><p>Simply put, the pattern-growth approach will build a tree to represent the relations between the items. Then the association rules will be calculated based on the tree.</p><h3 id=vertical-data-format>Vertical Data Format</h3><p>The table</p><table><thead><tr><th align=center>INDEX</th><th align=center>Items</th></tr></thead><tbody><tr><td align=center>1</td><td align=center>croissant, milk</td></tr><tr><td align=center>2</td><td align=center>coffee, croissant</td></tr><tr><td align=center>3</td><td align=center>coffee, croissant</td></tr><tr><td align=center>4</td><td align=center>coffee, croissant, milk</td></tr><tr><td align=center>5</td><td align=center>coffee, milk</td></tr><tr><td align=center>6</td><td align=center>fries, milk</td></tr><tr><td align=center>7</td><td align=center>coffee, croissant, fries</td></tr><tr><td align=center>8</td><td align=center>croissant, fries</td></tr><tr><td align=center>9</td><td align=center>croissant, milk</td></tr><tr><td align=center>10</td><td align=center>croissant, fries, milk</td></tr><tr><td align=center>11</td><td align=center>coffee, croissant, milk</td></tr></tbody></table><p>becomes vertical data format if we have</p><table><thead><tr><th align=center>Item</th><th align=center>Item ID</th></tr></thead><tbody><tr><td align=center>coffee</td><td align=center>{2,3,4,5,11}</td></tr><tr><td align=center>croissant</td><td align=center>{1,2,3,4,7,8,9,10,11}</td></tr><tr><td align=center>fries</td><td align=center>{6,7,8}</td></tr><tr><td align=center>milk</td><td align=center>{1,4,5,6,9,10,11}</td></tr></tbody></table><p>Finding frequent itemsets becomes set operations. For examples, to calculate the support count of {coffee, croissant}, we will find the intersection of the two item id sets associated with coffee and croissant, i.e.,</p>$$
\begin{equation}
\{2,3,4,5,11\} \cap \{1,2,3,4,7,8,9,10,11\} = \{ 2,3,4,11 \}
\end{equation}
$$<h2 id=the-right-way-of-using-association-rules>The Right Way of Using Association Rules</h2><p>From the previous calculations, we find the association rule</p>$$
\begin{equation}
\text{coffee} \Rightarrow \text{croissant} [ \text{support} = 45\%,\text{confidence} = 83\% ]
\end{equation}
$$<p>We know that the support for croissants is 82%. The fact that the confidence of this association rule is 83% makes this association rule not so interesting. Even without buying coffee, 82% of the records already have croissants in it. Buying coffee first doesn&rsquo;t really increase the probability of purchasing croissant significantly.</p><p>Sometime the confidence might even be lower than the probability of purchasing croissant, in which case coffee would decrease the probability of purchasing croissant.</p><p>This example shows that we should combine association rules with some other correlation measures. One of such measures is the lift.</p><p>Lift is defined as</p><p>\begin{equation}
\text{Lift}(\text{coffee}, \text{croissant} ) = \frac{ P( \text{coffee} \cup \text{croissant} ) }{ P(\text{coffee}) P(\text{croissant}) }
\end{equation}</p><p>When we have the lift equals 1, the two events are independent. If the lift is greater than 1, the probability of the union of coffee and croissant is larger than the assumed independent probability, which means some items in the two sets are correlated indicating a positive correlation between the two sets. If the lift is less than 1, the two sets are negatively correlated.</p><p>Another measure is <a href=/wiki/statistics/correlation-analysis-chi-square/>chi-square analysis</a>.</p></div><p><div class="has-text-right is-size-7"><span class=icon><i class="fas fa-pencil-alt"></i></span>Published: <time datetime=2019-01-06T00:00:00+00:00>2019-01-06</time>
by <span itemprop=author>Lei Ma</span>;</div></p><div class=is-divider></div><nav class="pagination is-centered" role=navigation aria-label=pagination></nav></div><div class="column is-4"><div class=is-divider data-content="Cite Me"></div><div class="box is-size-7 has-text-white has-background-black"><article class=media style=overflow-x:scroll><div class=media-content><div class=content><p>Lei Ma
(2019). 'Association Rules', Datumorphism, 01 April. Available at: https://datumorphism.leima.is/wiki/pattern-mining/association-rules/.</p></div></div></article></div><style>#TableOfContents>ul{list-style-type:lower-greek;padding-left:0}#TableOfContents>ul>li ul{list-style-type:none;padding-left:1em}</style><div class=is-divider data-content=ToC></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><details><summary>Table of Contents</summary><div><div><nav id=TableOfContents><ul><li><a href=#the-problem-defined>The Problem Defined</a></li><li><a href=#the-rule-support-and-confidence>The Rule, Support, and Confidence</a></li><li><a href=#keywords>Keywords</a></li><li><a href=#algorithms>Algorithms</a><ul><li><a href=#apriori-method>Apriori Method</a></li><li><a href=#pattern-growth-approach>Pattern-growth Approach</a></li><li><a href=#vertical-data-format>Vertical Data Format</a></li></ul></li><li><a href=#the-right-way-of-using-association-rules>The Right Way of Using Association Rules</a></li></ul></nav></div></div></details></div></div></article></div><script>const el=document.querySelector('details summary')
el.onclick=()=>{(function(l,o,a,d,e,r){e=o.createElement(a),r=o.getElementsByTagName(a)[0];e.async=1;e.src=d;r.parentNode.insertBefore(e,r)})(window,document,'script','/js/smoothscroll.js');el.onclick=null}
document.querySelectorAll('#TableOfContents a').forEach(link=>{link.addEventListener('click',()=>{document.querySelector(link.href.slice(link.href.indexOf('#'))).scrollIntoView({behavior:'smooth'})})})</script><div class=is-divider data-content=REFERENCES></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><p><strong>References:</strong><br><ol><li class=has-text-weight-bold><a href style=text-decoration:none>Data Mining by Jiawei Han, Micheline Kamber, Jian Pei</a></li></ol></p></div></div></article></div><div class=is-divider data-content=CONNECTUME></div><div class="box is-size-7"><article class=media><div class=media-content style=width:100%><div class=content><p><strong>Current Ref:</strong><br><ul><li style=list-style:none><div style=overflow-x:scroll>wiki/pattern-mining/association-rules.md</div></li></ul></p></div></div></article></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><p><strong>Links to:</strong><div><a class=box href=https://datumorphism.leima.is/wiki/statistics/correlation-analysis-chi-square/><div class=media-content><div class=content><h6>Chi-square Correlation Test for Nominal Data</h6><p>Detecting correlations using Pearson's chi square correlation test</p></div></div></a></div></p></div></div></article></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><p><strong>Links from:</strong><div><a class=box href=https://datumorphism.leima.is/wiki/machine-learning/bayesian/naive-bayes/><div class=media-content><div class=content><h6>Naive Bayes</h6><p>Naive Bayes</p></div></div></a></div></p></div></div></article></div><div id=comments class=is-divider data-content=COMMENTS></div><script src=https://utteranc.es/client.js repo=datumorphism/comments issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></article></div></section></div><div class=navtools><a class="button is-primary is-light is-outlined" alt="Edit this page" href=https://github.com/datumorphism/datumorphism.github.io/edit/hugo/content/wiki/pattern-mining/association-rules.md target=blank style=position:fixed;bottom:20px;right:10px;border-radius:9999px;width:35px;height:35px><i class="fas fa-pencil-alt"></i></a><a class="button is-primary is-light is-outlined" href=#comments alt=Comments style=position:fixed;bottom:60px;right:10px;border-radius:9999px;width:35px;height:35px><i class="far fa-comments"></i></a><a class="button is-primary is-light is-outlined" data-lyket-type=updown data-lyket-id=association-rules data-lyket-namespace=Datumorphism data-lyket-template=reddit style=width:35px;height:35px;position:fixed;bottom:120px;right:10px;border-radius:9999px></a></div></main><footer><script src=https://identity.netlify.com/v1/netlify-identity-widget.js></script><footer class=footer><div class=container><div class="content has-text-centered"><p>Created and maintained by <a href=https://leima.is>Lei Ma</a>.
Acknowledgement: <a href=https://gohugo.io/>Hugo</a>,
<a href=https://themes.gohugo.io/bulma/>Bulma</a>, <a href=https://kausalflow.com>KausalFlow</a>.
<strong>love</strong>.<br><a class=tag href=/about>About</a>
<a class=tag href=/index.xml>Feed</a>
<a class=tag href=/data.json>JSON Data</a></p></div></div></footer><script src=https://unpkg.com/applause-button/dist/applause-button.js></script></footer><script src="https://unpkg.com/@lyket/widget@latest/dist/lyket.js?apiKey=4df20b7e32f469fed5dc53f5ab39d8&disableSessionId"></script><script async type=text/javascript src=/js/bulma.js></script></body></html>